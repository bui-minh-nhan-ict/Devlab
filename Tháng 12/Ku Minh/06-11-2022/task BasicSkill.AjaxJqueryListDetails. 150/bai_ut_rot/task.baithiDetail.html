<!DOCTYPE html>
<html lang="en">

<head>
  <title>Task bs150 detail of posts</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</head>

<body onload = "onPageLoad()">
  <div class="jumbotron bg-light">
    <div class="row text-center my-4">
      <h3 class = "text-info" >CHI TIẾT COMMENT (BÌNH LUẬN)</h3>
    </div>
    <div class = "row form-group">
        <div class = "col-sm-4"> 
          <label class = "form-control border border-0 text-dark"> Id: </label>
        </div>
        <div class = "col-sm-8"> 
          <input type="text" class = "form-control" id = "inp-id" placeholder="..." >
        </div> 
    </div>
    <div class = "row form-group">
      <div class = "col-sm-4"> 
        <label class = "form-control border border-0 text-dark"> Post Id: </label>
      </div>
      <div class = "col-sm-8"> 
        <input type="text" class = "form-control" id = "inp-post-id" placeholder="..." >
      </div> 
    </div>
    <div class = "row form-group">
      <div class = "col-sm-4"> 
        <label class = "form-control border border-0 text-dark"> Email: </label>
      </div>
      <div class = "col-sm-8"> 
        <input type="text" class = "form-control" id = "inp-email" placeholder="..." >
      </div> 
    </div>
    <div class = "row form-group">
      <div class = "col-sm-4"> 
        <label class = "form-control border border-0 text-dark"> Name: </label>
      </div>
      <div class = "col-sm-8"> 
        <input type="text" class = "form-control" id = "inp-name"  >
      </div> 
    </div>
    <div class = "row form-group">
      <div class = "col-sm-4"> 
        <label class = "form-control border border-0 text-dark"> Body: </label>
      </div>
      <div class = "col-sm-8"> 
        <textarea  class = "form-control" placeholder="nội dung post" id = "area-post-body">  </textarea>
      </div> 
    </div>
  </div>
</body>
<script>
  /*** REGION 2 - Vùng gán / thực thi sự kiện cho các elements */

  /*** REGION 3 - Event handlers - Vùng khai báo các hàm xử lý sự kiện */
  // hàm xử lý sự kiện lấy Id của người dùng (4 bước xử lý)
  function onPageLoad() {
        //1.đọc dữ liệu
        var vIdObject = {  Id : "" };
        readDataIdObject(vIdObject); 
        //2.kiểm tra
        var vKetQuaKiemTra = validateIdObject(vIdObject);
        if (!vKetQuaKiemTra) {
          console.assert("Dữ liệu ko đạt chuẩn");
          return; //không làm nữa, thoát ra
        }
        //3. gọi server 
        //base url
        const vURL_GET_ID_DETAIL = "https://jsonplaceholder.typicode.com/comments/" + vIdObject.Id;
        $.ajax({
          url: vURL_GET_ID_DETAIL,
          type: 'GET',
          dataType: 'json', // added data type
          success: function (responseObject) {
            console.log(JSON.stringify(responseObject));  //response text
            //bước 4. xử lý hiện thị 
            hienThiDuLieu(responseObject);  //chính là Id object
          },
          error: function (ajaxContext) {
            alert(ajaxContext.responseText);
          }
        });
    }
  //hiện thị dữ liệu Id
  function hienThiDuLieu(paramObject) {
    $("#inp-id").val(paramObject.id);
    $("#inp-post-id").val(paramObject.postId);
    $("#inp-email").val(paramObject.email);
    $("#inp-name").val(paramObject.name);
    $("#area-post-body").val(paramObject.body);

  }
  // read data
  function readDataIdObject(paramIdObject) {
    var vUrlString = window.location.href;
    var vURL = new URL(vUrlString);
    var vId = vURL.searchParams.get("id");

    paramIdObject.Id = vId;
  }
  // validate data
  function validateIdObject(paramIdObject) {
    if (paramIdObject.Id === "") {
      alert ("Dữ liệu cần truyền vào !");
      return false;
    } 
    if ( isNaN(paramIdObject.Id)) {
      alert ("Dữ liệu là số nguyên !");
      return false;
    } 
    return true;
  }
</script>
</html>

